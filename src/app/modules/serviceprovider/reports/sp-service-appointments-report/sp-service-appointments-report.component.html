<div class="report pt-1 container">
  <div
    id="content"
    class="shadow"
    style="padding-left: 10px; padding-right: 10px;"
  >
    <div class="pt-5 pb-3" *ngIf="appointData.length">
      <div class="title text-center">
        <h2 style="font-weight: bold; color: darkmagenta;" class="strong">
          Evenza - Smart event Management & Resourcing Platform
        </h2>
        <br />
        <h3>
          <b>
            <mdb-icon fas icon="calendar-check"> </mdb-icon> Service
            Appointments Business report :
          </b>
        </h3>
      </div>
      <hr />
      <h5>
        <b>
          From : {{ ServiceAppoint.from_date.toISOString().slice(0, 10) }} To :
          {{ ServiceAppoint.to_date.toISOString().slice(0, 10) }}</b
        >
      </h5>
      <br />
      <h5>
        <b>
          Service Provider :
          {{
            appointData[0].serviceProvider.name +
              " | " +
              appointData[0].serviceProvider.email
          }}</b
        >
      </h5>
      <hr />
    </div>
    <div class="row">
      <div class="col-md-4">
        <iframe
          style="
            background: #ffffff;
            border: none;
          "
          width="100%"
          height="400"
          [src]="url1"
        ></iframe>
      </div>
      <div class="col-md-4">
        <iframe
          style="
            background: #ffffff;
            border: none;
          "
          width="100%"
          height="400"
          [src]="url2"
        ></iframe>
      </div>
      <div class="col-md-4">
        <iframe
          style="
            background: #ffffff;
            border: none;
          "
          width="100%"
          height="400"
          [src]="url3"
        ></iframe>
      </div>
    </div>
    <br /><br />
    <div class="text-center">
      <h3><strong> Service Order History</strong></h3>
      <hr />
      <h5>Pending Service Orders:</h5>
      <table
        class="table-striped pt-1"
        style="width: 100%;"
        *ngIf="pending.length"
      >
        <thead>
          <tr>
            <th>
              <b>
                Year & Month
              </b>
            </th>
            <th>
              Service Appointment ID
            </th>
            <th>
              Service Appointed
            </th>
            <th>
              Appointed Date
            </th>
            <th>
              Appointed time
            </th>
            <th>
              Customer
            </th>
          </tr>
        </thead>
        <tbody>
          <tr style="padding-bottom: 10px;" *ngFor="let s of pending">
            <td>
              {{ s.year + " - " + s.month }}
            </td>
            <td>
              {{ s.appoint_id }}
            </td>
            <td>
              {{ s.service_name }}
            </td>
            <td>
              {{ s.appointed_date.slice(0, 10) }}
            </td>
            <td>
              {{ s.appointed_date.slice(11, 16) }}
            </td>
            <td>
              {{ s.user.name }}
            </td>
          </tr>
        </tbody>
      </table>
      <div class="pt-4" *ngIf="!pending.length">No Pending Service Orders</div>
      <hr />
      <h5>Completed Service Orders:</h5>
      <table
        class="table-striped pt-1"
        style="width: 100%;"
        *ngIf="confirmed.length"
      >
        <thead>
          <tr>
            <th>
              <b>
                Year & Month
              </b>
            </th>
            <th>
              Service Appointment ID
            </th>
            <th>
              Service Appointed
            </th>
            <th>
              Appointed Date
            </th>
            <th>
              Appointed Time
            </th>
            <th>
              Customer
            </th>
          </tr>
        </thead>
        <tbody>
          <tr style="padding-bottom: 10px;" *ngFor="let s of confirmed">
            <td>
              {{ s.year + " - " + s.month }}
            </td>
            <td>
              {{ s.appoint_id }}
            </td>
            <td>
              {{ s.service_name }}
            </td>
            <td>
              {{ s.appointed_date.slice(0, 10) }}
            </td>
            <td>
              {{ s.appointed_date.slice(11, 16) }}
            </td>
            <td>
              {{ s.user.name }}
            </td>
          </tr>
        </tbody>
      </table>
      <div class="pt-4" *ngIf="!confirmed.length">
        No Completed Service Orders
      </div>
      <hr />
      <h5>Cancelled Service Orders:</h5>
      <table
        class="table-striped pt-1"
        style="width: 100%;"
        *ngIf="cancelled.length"
      >
        <thead>
          <tr>
            <th>
              <b>
                Year & Month
              </b>
            </th>
            <th>
              Service Appointment ID
            </th>
            <th>
              Service Appointed
            </th>
            <th>
              Appointed Date
            </th>
            <th>
              Appointed time
            </th>
            <th>
              Customer
            </th>
          </tr>
        </thead>
        <tbody>
          <tr style="padding-bottom: 10px;" *ngFor="let s of cancelled">
            <td>
              {{ s.year + " - " + s.month }}
            </td>
            <td>
              {{ s.appoint_id }}
            </td>
            <td>
              {{ s.service_name }}
            </td>
            <td>
              {{ s.appointed_date.slice(0, 10) }}
            </td>
            <td>
              {{ s.appointed_date.slice(11, 16) }}
            </td>
            <td>
              {{ s.user.name }}
            </td>
          </tr>
        </tbody>
      </table>
      <div class="pt-4" *ngIf="!cancelled.length">
        No Cancelled Service Orders
      </div>
    </div>
    <hr />
    <div class="text-center">
      Report is generated and approved by Evenza Systems. No Signature required.
      <br />
      <b> Evenza 2020</b>
    </div>
  </div>
  <!-- end of report-->
  <hr />

  <div class="btns text-center">
    <button
      mdbBtn
      color="primary"
      class="btn btn-md edtbt"
      mdbWavesEffect
      (click)="printReport('content', 'Service_Order_Report')"
    >
      Print Report
    </button>
    <button
      mdbBtn
      color="primary"
      class="btn btn-md edtbt"
      mdbWavesEffect
      (click)="emailReport(reportUrl, 'Service_Order_Report')"
    >
      Request by Email
    </button>
  </div>
</div>
